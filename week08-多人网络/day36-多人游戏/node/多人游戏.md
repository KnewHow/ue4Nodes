# Day36-多人游戏

## 1 运行专有服务器

![image-20200622091034587](../images/image-20200622091034587.png)

勾上时，服务器在后台运行，屏幕上的都是玩家。

### 1.1 监测当前玩家是否是服务器

![image-20200622092254318](../images/image-20200622092254318.png)

### 1.2 测试玩家是客户端还是服务器

判断当前玩家是服务器还是客户端：

![image-20200622092701082](../images/image-20200622092701082.png)

#### 1.2.1 当设置的玩家为一个时

![image-20200622092744953](../images/image-20200622092744953.png)

该玩家为服务器：

![image-20200622092800777](../images/image-20200622092800777.png)

#### 1.2.2 当玩家设置为多个时

![image-20200622092900297](../images/image-20200622092900297.png)

主屏为 Server,其余屏幕为Client:

![image-20200622092940476](../images/image-20200622092940476.png)



#### 1.2.3 当运行专有服务器时

![image-20200622093019366](../images/image-20200622093019366.png)

所有玩家都是客户端：

![image-20200622093047709](../images/image-20200622093047709.png)



### 1.3 class Details 中 Replacates

设置 Replacates 代表该类可以被复制到客户端

![image-20200622093516878](../images/image-20200622093516878.png)



### 1.4 服务器和客户端的关系

![image-20200622094735847](../images/image-20200622094735847.png)

### 1.5 变量中的 RepNotify/Replicated

Replicated 每帧都会去通知客户端，而RepNotify会调用自定义的函数，下图中是`ONRep_color`,使用者可以在`OnRep_color`自定义通知的逻辑

![image-20200622105333841](../images/image-20200622105333841.png)



### 1.6 事件中的 Replicates

![image-20200622111028700](../images/image-20200622111028700.png)

只让客户端执行：

![image-20200622164814236](../images/image-20200622164814236.png)

只让服务器执行：

![image-20200622164934655](../images/image-20200622164934655.png)



## 2 实现网络多人聊天

### 2.1 UI 中的 EditInput 对文本的监听事件

![image-20200622134613933](../images/image-20200622134613933.png)



实现消息发送和添加：

![image-20200622164521640](../images/image-20200622164521640.png)


实现消息记录的添加：

![image-20200622164550685](../images/image-20200622164550685.png)

### 2.2 让鼠标聚焦

![image-20200622163338459](../images/image-20200622163338459.png)

### 2.3 对登录和退出做处理

![image-20200622163140075](../images/image-20200622163140075.png)



### 2.4 定义接收事件

![image-20200622163519184](../images/image-20200622163519184.png)

### 2.5 定义发送事件

![image-20200622163852158](../images/image-20200622163852158.png)

### 2.6 输入 Entry 自动定位到输入框

![image-20200622163941008](../images/image-20200622163941008.png)